<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     叶枫
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

</head>

</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover4.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">叶枫</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['面朝大海，春暖花开', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article
  id="post-MyBatis"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/05/30/MyBatis/"
    >Mybatis</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/05/30/MyBatis/" class="article-date">
  <time datetime="2020-05-30T04:04:09.000Z" itemprop="datePublished">2020-05-30</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="resultmap的细节问题"><a href="#resultmap的细节问题" class="headerlink" title="resultmap的细节问题"></a>resultmap的细节问题</h2><p>表的id不能冲突到。<br>property 是java的初始变量<br>column 要与数据库的值一一对应</p>
<p>（1）mybatis在处理#{}时，会将sql中的#{}替换为?号，调用PreparedStatement的set方法来赋值。</p>
<p>（2）mybatis在处理${}时，就是把${}替换成变量的值。</p>
<p>（3）使用#{}可以有效的防止SQL注入，提高系统安全性。原因在于：预编译机制。预编译完成之后，SQL的结构已经固定，即便用户输入非法参数，也不会对SQL的结构产生影响，从而避免了潜在的安全风险</p>
<h3 id="一对一"><a href="#一对一" class="headerlink" title="一对一"></a>一对一</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap <span class="built_in">type</span>=<span class="string">"com.liulanghan.Blog"</span> id=<span class="string">"BlogResult"</span>&gt;    </span><br><span class="line">    &lt;id column=<span class="string">"id"</span> property=<span class="string">"id"</span>/&gt;    </span><br><span class="line">    &lt;result column=<span class="string">"title"</span> property=<span class="string">"title"</span>/&gt;    </span><br><span class="line">    &lt;result column=<span class="string">"content"</span> property=<span class="string">"content"</span>/&gt;    </span><br><span class="line">    &lt;result column=<span class="string">"owner"</span> property=<span class="string">"owner"</span>/&gt;    </span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">&lt;select id=<span class="string">"selectBlog"</span> parameterType=<span class="string">"int"</span> resultMap=<span class="string">"BlogResult"</span>&gt;    </span><br><span class="line">      select * from t_blog <span class="built_in">where</span> id = <span class="comment">#&#123;id&#125;    </span></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<h3 id="一对多"><a href="#一对多" class="headerlink" title="一对多"></a>一对多</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap <span class="built_in">type</span>=<span class="string">"BookCategroy"</span> id=<span class="string">"selectmessage"</span>&gt;</span><br><span class="line">	&lt;id property=<span class="string">"typeid"</span> column=<span class="string">"type_id"</span>&gt;&lt;/id&gt;</span><br><span class="line">	&lt;result property=<span class="string">"booktype"</span> column=<span class="string">"book_type"</span>/&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;collection property=<span class="string">"books"</span> ofType=<span class="string">"Book"</span>&gt;</span><br><span class="line">		&lt;id property=<span class="string">"id"</span> column=<span class="string">"id"</span>&gt;&lt;/id&gt;</span><br><span class="line">		&lt;result property=<span class="string">"book_name"</span> column=<span class="string">"book_name"</span>/&gt;</span><br><span class="line">		&lt;result property=<span class="string">"press"</span> column=<span class="string">"press"</span>/&gt;</span><br><span class="line">		&lt;result property=<span class="string">"price"</span> column=<span class="string">"price"</span>/&gt;</span><br><span class="line">	&lt;/collection&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"bookmessage"</span> resultMap=<span class="string">"selectmessage"</span>&gt;</span><br><span class="line">	SELECT bc.*,b.* FROM book_categroy </span><br><span class="line">	AS bc inner JOIN book AS b</span><br><span class="line">	ON  bc.type_id = b.book_type</span><br><span class="line">	<span class="built_in">where</span> bc.type_id = <span class="comment">#&#123;id&#125;</span></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p>oftype 是实体类的集合 list<Book><br>id 必须一对一对应<br>一对多的话就用<collection></collection></Book></p>
<h3 id="多对一"><a href="#多对一" class="headerlink" title="多对一"></a>多对一</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap <span class="built_in">type</span>=<span class="string">"book"</span> id=<span class="string">"selectmessage"</span>&gt;</span><br><span class="line">	&lt;id property=<span class="string">"id"</span> column=<span class="string">"id"</span>&gt;&lt;/id&gt;</span><br><span class="line">	&lt;result property=<span class="string">"book_name"</span> column=<span class="string">"book_name"</span>/&gt;</span><br><span class="line">	&lt;result property=<span class="string">"press"</span> column=<span class="string">"press"</span>/&gt;</span><br><span class="line">	&lt;result property=<span class="string">"price"</span> column=<span class="string">"price"</span>/&gt;</span><br><span class="line">	&lt;association property=<span class="string">"bookcategroy"</span> javaType=<span class="string">"BookCategroy"</span>&gt;</span><br><span class="line">		&lt;id property=<span class="string">"typeid"</span> column=<span class="string">"type_id"</span>&gt;&lt;/id&gt;</span><br><span class="line">		&lt;result property=<span class="string">"booktype"</span> column=<span class="string">"book_type"</span>/&gt;</span><br><span class="line">	&lt;/association&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line">&lt;select id=<span class="string">"bookmessage"</span> resultMap=<span class="string">"selectmessage"</span>&gt;</span><br><span class="line">	SELECT bc.*,b.* FROM book_categroy </span><br><span class="line">	AS b inner JOIN book_categroy  AS bc</span><br><span class="line">	ON  b.book_type = bc.type_id</span><br><span class="line">	<span class="built_in">where</span> b.id = <span class="comment">#&#123;id&#125;</span></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>多对一就用<association></association></p>
<h3 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a><where>动态sql</where></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">where</span>&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"id!=null"</span>&gt;and \<span class="comment">#&#123;id&#125;,&lt;/if&gt;</span></span><br><span class="line">	&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"name!=null"</span>&gt;and \<span class="comment">#&#123;name&#125;,&lt;/if&gt;</span></span><br><span class="line">&lt;/<span class="built_in">where</span>&gt;</span><br></pre></td></tr></table></figure>

<p>可以去除结尾的，和多余的and</p>
<h3 id="sql"><a href="#sql" class="headerlink" title="sql"></a><set>sql</set></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">update order </span><br><span class="line">&lt;<span class="built_in">set</span>&gt;</span><br><span class="line">	&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"id!=null"</span>&gt;id = \<span class="comment">#&#123;id&#125;,&lt;/if&gt;</span></span><br><span class="line">	&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">"name!=null"</span>&gt;name = \<span class="comment">#&#123;name&#125;&lt;/if&gt;</span></span><br><span class="line">&lt;/<span class="built_in">set</span>&gt;</span><br></pre></td></tr></table></figure>
<p>去掉多余的,</p>
<h3 id="sql-1"><a href="#sql-1" class="headerlink" title="sql"></a><trim>sql</trim></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;insert id=<span class="string">"InsertStudent"</span> parameterType=<span class="string">"Student"</span>&gt;</span><br><span class="line"></span><br><span class="line">Insert into stud_info </span><br><span class="line"></span><br><span class="line">&lt;trim prefix=<span class="string">"("</span> suffix=<span class="string">")"</span> suffixOverrides=<span class="string">","</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'id!=null'</span>&gt;id,&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'sname!=null'</span>&gt;sname,&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'birthday!=null'</span>&gt;birthday,&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'gender!=null'</span>&gt;gender,&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'telcode!=null'</span>&gt;telcode,&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'mark!=null'</span>&gt;mark&lt;/<span class="keyword">if</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/trim&gt;</span><br><span class="line"></span><br><span class="line">&lt;trim prefix=<span class="string">"values("</span> suffix=<span class="string">")"</span> suffixOverrides=<span class="string">","</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'id!=null'</span>&gt;<span class="comment">#&#123;id&#125;,&lt;/if&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'sname!=null'</span>&gt;<span class="comment">#&#123;sname&#125;,&lt;/if&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'birthday!=null'</span>&gt;<span class="comment">#&#123;birthday&#125;,&lt;/if&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'gender!=null'</span>&gt;<span class="comment">#&#123;gender&#125;,&lt;/if&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'telcode!=null'</span>&gt;<span class="comment">#&#123;telcode&#125;,&lt;/if&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="keyword">if</span> <span class="built_in">test</span>=<span class="string">'mark!=null'</span>&gt;<span class="comment">#&#123;mark&#125;&lt;/if&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/trim&gt;</span><br><span class="line"></span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>

<p>prefix为前缀 suffix为后缀 suffixOverrides结尾去除，</p>
<h3 id="注解形式"><a href="#注解形式" class="headerlink" title="注解形式"></a>注解形式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Select(<span class="string">"&lt;script&gt;\r\n"</span> + </span><br><span class="line"></span><br><span class="line"><span class="string">"select * from book \r\n"</span> + </span><br><span class="line"></span><br><span class="line"><span class="string">"&lt;where&gt;\r\n"</span> + </span><br><span class="line"></span><br><span class="line"><span class="string">"&lt;if test=\"name!=null\"&gt;book_name = #&#123;name&#125;&lt;/if&gt;\r\n"</span> + </span><br><span class="line"></span><br><span class="line"><span class="string">"&lt;/where&gt;&lt;/script&gt;\r\n"</span>)</span><br><span class="line"></span><br><span class="line">public Book selectbookmessage(String name);</span><br></pre></td></tr></table></figure>
<p>如果是动态标签那么要加上<script></script></p>
<h3 id="sql-2"><a href="#sql-2" class="headerlink" title="sql"></a><foreach>sql</foreach></h3><p>item：集合中元素迭代时的别名，该参数为必选。<br>index：在list和数组中,index是元素的序号，在map中，index是元素的key，该参数可选<br>open：foreach代码的开始符号，一般是(和close=”)”合用。常用在in(),values()时。该参数可选<br>separator：元素之间的分隔符，例如在in()的时候，separator=”,”会自动在元素中间用“,“隔开，避免手动输入逗号导致sql错误，如in(1,2,)这样。该参数可选。<br>close: foreach代码的关闭符号，一般是)和open=”(“合用。常用在in(),values()时。该参数可选。<br>collection: 要做foreach的对象，作为入参时，List对象默认用”list”代替作为键，数组对象有”array”代替作为键，Map对象没有默认的键。当然在作为入参时可以使用@Param(“keyName”)来设置键，设置keyName后，list,array将会失效。 除了入参这种情况外，还有一种作为参数对象的某个字段的时候。举个例子：如果User有属性List ids。入参是User对象，那么这个collection = “ids”.如果User有属性Ids ids;其中Ids是个对象，Ids有个属性List id;入参是User对象，那么collection = “ids.id”</p>
<p>list</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">"countByUserList"</span> resultType=<span class="string">"_int"</span> parameterType=<span class="string">"list"</span>&gt;</span><br><span class="line">select count(*) from users</span><br><span class="line">  &lt;<span class="built_in">where</span>&gt;</span><br><span class="line">    id <span class="keyword">in</span></span><br><span class="line">    &lt;foreach item=<span class="string">"item"</span> collection=<span class="string">"list"</span> separator=<span class="string">","</span> open=<span class="string">"("</span> close=<span class="string">")"</span> index=<span class="string">""</span>&gt;</span><br><span class="line">      <span class="comment">#&#123;item.id, jdbcType=NUMERIC&#125;</span></span><br><span class="line">    &lt;/foreach&gt;</span><br><span class="line">  &lt;/<span class="built_in">where</span>&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<p>数组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=<span class="string">"dynamicForeach2Test"</span> resultType=<span class="string">"Blog"</span>&gt;</span><br><span class="line">     select * from t_blog <span class="built_in">where</span> id <span class="keyword">in</span></span><br><span class="line">     &lt;foreach collection=<span class="string">"array"</span> index=<span class="string">"index"</span> item=<span class="string">"item"</span> open=<span class="string">"("</span> separator=<span class="string">","</span> close=<span class="string">")"</span>&gt;</span><br><span class="line">          <span class="comment">#&#123;item&#125;</span></span><br><span class="line">     &lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line"> public void <span class="function"><span class="title">dynamicForeach2Test</span></span>() &#123;</span><br><span class="line">     SqlSession session = Util.getSqlSessionFactory().openSession();</span><br><span class="line">     BlogMapper blogMapper = session.getMapper(BlogMapper.class);</span><br><span class="line">     int[] ids = new int[] &#123;1,3,6,9&#125;;</span><br><span class="line">     List blogs = blogMapper.dynamicForeach2Test(ids);</span><br><span class="line">     <span class="keyword">for</span> (Blog blog : blogs)</span><br><span class="line">     System.out.println(blog);</span><br><span class="line">     session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>map</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void <span class="function"><span class="title">testInserts</span></span>()&#123;</span><br><span class="line">    Map&lt;String,List&lt;Object&gt;&gt; param = new HashMap&lt;String,List&lt;Object&gt;&gt;();</span><br><span class="line">    List&lt;Object&gt; l = new ArrayList&lt;Object&gt;();</span><br><span class="line">    User u1 = new User();</span><br><span class="line">    u1.setUserName(<span class="string">"u1_name"</span>);</span><br><span class="line">    u1.setPassword(<span class="string">"11111"</span>);</span><br><span class="line">    u1.setName(<span class="string">"u1"</span>);</span><br><span class="line">    u1.setSex(1);</span><br><span class="line">    u1.setAge(20);</span><br><span class="line">    u1.setCreated(new Date());</span><br><span class="line">    u1.setBirthday(new Date());</span><br><span class="line">    u1.setUpdated(new Date());</span><br><span class="line">    User u2 = new User();</span><br><span class="line">    u2.setUserName(<span class="string">"u2_name"</span>);</span><br><span class="line">    u2.setPassword(<span class="string">"11111"</span>);</span><br><span class="line">    u2.setName(<span class="string">"u2"</span>);</span><br><span class="line">    u2.setSex(1);</span><br><span class="line">    u2.setAge(20);</span><br><span class="line">    u2.setCreated(new Date());</span><br><span class="line">    u2.setBirthday(new Date());</span><br><span class="line">    u2.setUpdated(new Date());</span><br><span class="line">    l.add(u1);</span><br><span class="line">    l.add(u2);</span><br><span class="line">    param.put(<span class="string">"keys"</span>, l);</span><br><span class="line">    int count = this.userMapper.insertUsers(param);</span><br><span class="line">    System.out.println(<span class="string">"..............."</span>+count);</span><br><span class="line">&#125;</span><br><span class="line">//如果使用@param(<span class="string">"xxx"</span>)注解的话，foreach集合中的colleciton的值可以是<span class="string">"xxx.keys"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;insert id=<span class="string">"insertUsers"</span>&gt;</span><br><span class="line">   insert into tb_user</span><br><span class="line">   ( id, user_name, password,sex,</span><br><span class="line">     name, age, birthday, created, updated)</span><br><span class="line">   values</span><br><span class="line">   &lt;foreach collection=<span class="string">"keys"</span> item=<span class="string">"value"</span>  separator=<span class="string">","</span>&gt;</span><br><span class="line">      (null,<span class="comment">#&#123;value.userName&#125;,#&#123;value.password&#125;,#&#123;value.sex&#125;,#&#123;value.name&#125;,#&#123;value.age&#125;,#&#123;value.birthday&#125;,#&#123;value.created&#125;,#&#123;value.updated&#125;)</span></span><br><span class="line">   &lt;/foreach&gt;</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure>

<h3 id="类型转换器"><a href="#类型转换器" class="headerlink" title="类型转换器"></a>类型转换器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">package org.Dao.processor;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.type.BaseTypeHandler;</span><br><span class="line">import org.apache.ibatis.type.JdbcType;</span><br><span class="line"></span><br><span class="line">import java.sql.CallableStatement;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line"></span><br><span class="line">public class SexTypeHandler extends BaseTypeHandler&lt;String&gt; &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void setNonNullParameter(PreparedStatement ps, int i, String parameter, JdbcType jdbcType) throws SQLException &#123;</span><br><span class="line">        <span class="keyword">if</span> (parameter.equals(<span class="string">"男"</span>)) &#123;</span><br><span class="line">            ps.setString(i,<span class="string">"1"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ps.setString(i,<span class="string">"0"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getNullableResult(ResultSet rs, String columnName) throws SQLException &#123;</span><br><span class="line">        <span class="built_in">return</span> rs.getString(columnName).equals(<span class="string">"1"</span>)?<span class="string">"男"</span>:<span class="string">"女"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getNullableResult(ResultSet rs, int columnIndex) throws SQLException &#123;</span><br><span class="line">        <span class="built_in">return</span> rs.getString(columnIndex).equals(<span class="string">"1"</span>)?<span class="string">"男"</span>:<span class="string">"女"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getNullableResult(CallableStatement cs, int columnIndex) throws SQLException &#123;</span><br><span class="line">        <span class="built_in">return</span> cs.getString(columnIndex).equals(<span class="string">"1"</span>)?<span class="string">"男"</span>:<span class="string">"女"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">conf.xml配置</span><br><span class="line">&lt;!-- 创建处理器--&gt;</span><br><span class="line">    &lt;typeHandlers&gt;</span><br><span class="line">        &lt;typeHandler handler=<span class="string">"org.Dao.processor.StringTypeHandler"</span> javaType=<span class="string">"String"</span> jdbcType=<span class="string">"VARCHAR"</span>/&gt;</span><br><span class="line">        &lt;typeHandler handler=<span class="string">"org.Dao.processor.SexTypeHandler"</span> javaType=<span class="string">"String"</span> jdbcType=<span class="string">"VARCHAR"</span>/&gt;</span><br><span class="line">        &lt;typeHandler handler=<span class="string">"org.Dao.processor.validTypeHandle"</span> /&gt;</span><br><span class="line">    &lt;/typeHandlers&gt;</span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-单例模式"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/05/23/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"
    >单例模式</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/05/23/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time datetime="2020-05-23T12:30:32.000Z" itemprop="datePublished">2020-05-23</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="饿汉模式（静态常量）"><a href="#饿汉模式（静态常量）" class="headerlink" title="饿汉模式（静态常量）"></a>饿汉模式（静态常量）</h3><p>优点：实现起来简单，没有多线程同步问题。<br>缺点：java加载时就初始化了静态变量instance，如果没有被使用就占用了内存空间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line"></span><br><span class="line">    // 将自身实例化对象设置为一个属性，并用static、final修饰</span><br><span class="line">    private static final Singleton instance = new Singleton();</span><br><span class="line">    </span><br><span class="line">    // 构造方法私有化</span><br><span class="line">    private <span class="function"><span class="title">Singleton</span></span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    // 公有静态方法返回该实例</span><br><span class="line">    public static Singleton <span class="function"><span class="title">getInstance</span></span>() &#123;</span><br><span class="line">        <span class="built_in">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="饿汉模式（静态代码块）"><a href="#饿汉模式（静态代码块）" class="headerlink" title="饿汉模式（静态代码块）"></a>饿汉模式（静态代码块）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line"></span><br><span class="line">    // 将自身实例化对象设置为一个属性，并用static、final修饰</span><br><span class="line">    private static final Singleton instance;</span><br><span class="line">    static &#123;</span><br><span class="line">    	instance = new Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 构造方法私有化</span><br><span class="line">    private <span class="function"><span class="title">Singleton</span></span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    // 公有静态方法返回该实例</span><br><span class="line">    public static Singleton <span class="function"><span class="title">getInstance</span></span>() &#123;</span><br><span class="line">        <span class="built_in">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>初始化类的实例。优 缺点和上面是一样的。 2) 结论：这种单例模式可用，但是可能造成内存浪费</p>
<h3 id="懒汉模式-延迟加载"><a href="#懒汉模式-延迟加载" class="headerlink" title="懒汉模式/延迟加载"></a>懒汉模式/延迟加载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line"></span><br><span class="line">    // 将自身实例化对象设置为一个属性，并用static修饰</span><br><span class="line">    private static Singleton instance;</span><br><span class="line">    </span><br><span class="line">    // 构造方法私有化</span><br><span class="line">    private <span class="function"><span class="title">Singleton</span></span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    // 静态方法返回该实例</span><br><span class="line">    public static Singleton <span class="function"><span class="title">getInstance</span></span>() &#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == null) &#123;</span><br><span class="line">            instance = new Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>优点 实现了单例模式<br>缺点 存在于多线程不安全</p>
<h3 id="线程安全的“懒汉模式”"><a href="#线程安全的“懒汉模式”" class="headerlink" title="线程安全的“懒汉模式”"></a>线程安全的“懒汉模式”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line"></span><br><span class="line">    // 将自身实例化对象设置为一个属性，并用static修饰</span><br><span class="line">    private static Singleton instance;</span><br><span class="line">    </span><br><span class="line">    // 构造方法私有化</span><br><span class="line">    private <span class="function"><span class="title">Singleton</span></span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    // 静态方法返回该实例，加synchronized关键字实现同步</span><br><span class="line">    public static synchronized Singleton <span class="function"><span class="title">getInstance</span></span>() &#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == null) &#123;</span><br><span class="line">            instance = new Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>优点 实现多线程安全 单列<br>缺点 每个线程进来都要同步getInstance() 同步锁耗费性能 导致效率低</p>
<h3 id><a href="#" class="headerlink" title></a></h3><h3 id="懒汉模式-线程安全"><a href="#懒汉模式-线程安全" class="headerlink" title="懒汉模式 线程安全"></a>懒汉模式 线程安全</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line"></span><br><span class="line">    // 将自身实例化对象设置为一个属性，并用static修饰</span><br><span class="line">    private volatile static Singleton instance;</span><br><span class="line">    </span><br><span class="line">    // 构造方法私有化</span><br><span class="line">    private <span class="function"><span class="title">Singleton</span></span>() &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    // 静态方法返回该实例</span><br><span class="line">    public static Singleton <span class="function"><span class="title">getInstance</span></span>() &#123;</span><br><span class="line">        // 第一次检查instance是否被实例化出来，如果没有进入<span class="keyword">if</span>块</span><br><span class="line">        <span class="keyword">if</span>(instance == null) &#123;</span><br><span class="line">            synchronized (Singleton.class) &#123;</span><br><span class="line">                // 某个线程取得了类锁，实例化对象前第二次检查instance是否已经被实例化出来，如果没有，才最终实例出对象</span><br><span class="line">                <span class="keyword">if</span> (instance == null) &#123;</span><br><span class="line">                    instance = new Singleton();//初始化顺序不一定，不是一个原子的操作</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">volatile 可以避免指令重排</span><br><span class="line">可见性:可以让参数看见给main线程看见</span><br><span class="line">原子性</span><br><span class="line">有序性</span><br><span class="line"></span><br><span class="line">1.分配内存空间</span><br><span class="line">2.执行构造方法 初始化对象</span><br><span class="line">3.把这个对象指向这个空间</span><br></pre></td></tr></table></figure>
<p>内存占用率高，效率高，线程安全，多线程</p>
<h3 id="懒汉模式内部类"><a href="#懒汉模式内部类" class="headerlink" title="懒汉模式内部类"></a>懒汉模式内部类</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Singleton &#123;</span><br><span class="line">	private <span class="function"><span class="title">Singleton</span></span>()&#123;&#125;</span><br><span class="line"></span><br><span class="line">	private statc class SingletonInstance&#123;</span><br><span class="line">		private static final Singleton singleton = new Singleton();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public static Singleton <span class="function"><span class="title">getInstance</span></span>()&#123;</span><br><span class="line">		<span class="built_in">return</span> SingletonInstance.singleton</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>静态内部类方式在Singleton类被装载时并不会立即实例化，而是在需要实例化 时，调用getInstance方法，才会装载SingletonInstance类，从而完成Singleton的 实例化。</p>
<p>类的静态属性只会在第一次加载类的时候初始化，所以在这里，帮助我们 保证了线程的安全性，在类进行初始化时，别的线程是无法进入的。</p>
<p>优点：避免了线程不安全，利用静态内部类特点实现延迟加载，效率高 </p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-io流"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/05/14/io%E6%B5%81/"
    >io流</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/05/14/io%E6%B5%81/" class="article-date">
  <time datetime="2020-05-14T08:19:51.000Z" itemprop="datePublished">2020-05-14</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="InputStream类"><a href="#InputStream类" class="headerlink" title="InputStream类"></a>InputStream类</h3><p>FileOutputStream(File file)<br>FileOutputStream(String name)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FileOutputStream outputStream = new FileOutputStream(<span class="string">"a.txt"</span>);</span><br><span class="line">OutputStream outputStream = new FileOutputStream(<span class="string">"a.txt"</span>);它的父类 加参数<span class="literal">true</span>为追加 不加置为覆盖</span><br><span class="line"></span><br><span class="line">outputStream.write(<span class="string">""</span>.getBytes()) </span><br><span class="line"></span><br><span class="line">outputStream.close() 关闭流</span><br></pre></td></tr></table></figure>
<p>通过字节流<br>public void write(int b) ask码<br>public void write(byte[] b) 字节<br>public void write(byte[] b,int off,int len)</p>
<p>byte[] bys={97,98,99,100,101};<br>outputStream.write(bys,1,3); 文本中出现bcd</p>
<h3 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">FileInputStream inputStream = new FileInputStream(<span class="string">"a.txt"</span>);</span><br><span class="line">//读一个字节</span><br><span class="line">int by = 0;</span><br><span class="line"><span class="keyword">while</span> ((by=inputStream.read())!=-1)&#123;</span><br><span class="line">      System.out.println((char)by);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//读一个字节数组，一般是1024大小</span><br><span class="line">int len = 0 ;</span><br><span class="line">byte[] bys = new byte[1024];</span><br><span class="line"><span class="keyword">while</span> ((len = inputStream.read(bys)) != -1) &#123;</span><br><span class="line">    System.out.println(new String(bys,0,len));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>两个read的返回值略有不同，read()返回读取的字节，读到末尾返回-1，read(byte[] b)返回的是读到的字节个数，读到的字节放在了bytes字节数组里，读到末尾没数据了返回-1。</p>
<h3 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FileInputStream inputStream = new FileInputStream(<span class="string">"a.txt"</span>);</span><br><span class="line">FileOutputStream outputStream = new FileOutputStream(<span class="string">"E:\\古月.jpg"</span>);</span><br><span class="line"></span><br><span class="line">//读一个字节数组，一般是1024大小</span><br><span class="line">int len = 0 ;</span><br><span class="line">byte[] bys = new byte[1024];</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ((len = inputStream.read(bys)) != -1) &#123;</span><br><span class="line">    outputStream.write(bys,0,len);</span><br><span class="line">&#125;</span><br><span class="line">inputStream.close();</span><br><span class="line">outputStream.close();</span><br></pre></td></tr></table></figure>

<h3 id="缓冲流"><a href="#缓冲流" class="headerlink" title="缓冲流"></a>缓冲流</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(<span class="string">"E:\\modern-java.pdf"</span>));</span><br><span class="line">BufferedInputStream bis = new BufferedInputStream(new FileInputStream(<span class="string">"F:\\汤包\\慕课大巴\\modern-java.pdf"</span>));</span><br><span class="line">int len = 0;</span><br><span class="line">byte[] bytes =new byte[1024];</span><br><span class="line"><span class="keyword">while</span> ((len=bis.read(bytes)) != -1) &#123;</span><br><span class="line">    bos.write(bytes,0,len);</span><br><span class="line">&#125;</span><br><span class="line">bis.close();</span><br><span class="line">bos.close();</span><br></pre></td></tr></table></figure>

<h3 id="将字节流转换为字符串"><a href="#将字节流转换为字符串" class="headerlink" title="将字节流转换为字符串"></a>将字节流转换为字符串</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">File file&#x3D;new File(realPath);</span><br><span class="line">FileInputStream in &#x3D; new FileInputStream(file);	&#x2F;&#x2F;文件读取</span><br><span class="line">String str &#x3D; &quot;&quot;;</span><br><span class="line">int size&#x3D;in.available();&#x2F;&#x2F;获取文件流</span><br><span class="line">byte[] buffer&#x3D;new byte[size];&#x2F;&#x2F;初始化byte 字节大小</span><br><span class="line">in.read(buffer);&#x2F;&#x2F;将文件读一次流</span><br><span class="line">in.close();</span><br><span class="line">str&#x3D;new String(buffer,&quot;ISO-8859-1&quot;);将字符串赋值为buffer 并且设置编码</span><br><span class="line">good.setStrimg(str);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> File file &#x3D; new File(path);&#x2F;&#x2F;获取路径文件</span><br><span class="line">if(!file.exists())&#123;判断文件是否存在</span><br><span class="line">    System.out.println(&quot;&#x2F;加载中&quot;);</span><br><span class="line">    byte[] bys &#x3D; article.getStrimg().getBytes(&quot;ISO-8859-1&quot;);&#x2F;&#x2F;将string以xxx编码初始化为bys大小</span><br><span class="line">    FileOutputStream outputStream &#x3D; new FileOutputStream(file);&#x2F;&#x2F;写入文件</span><br><span class="line">    InputStream is &#x3D; new ByteArrayInputStream(bys);&#x2F;&#x2F;将bys读取</span><br><span class="line">    int len &#x3D; 0;</span><br><span class="line">    byte[] buff &#x3D; new byte[1024];</span><br><span class="line">    while((len &#x3D; is.read(buff))!&#x3D;-1) &#123;</span><br><span class="line">        outputStream.write(buff, 0, len);&#x2F;&#x2F;写入文件</span><br><span class="line">    &#125;</span><br><span class="line">    is.close();</span><br><span class="line">    outputStream.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>文件的编码默认为ISO-8859-1</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-LinkedList"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/05/12/LinkedList/"
    >LineList</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/05/12/LinkedList/" class="article-date">
  <time datetime="2020-05-12T07:43:09.000Z" itemprop="datePublished">2020-05-12</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="关于链表集合"><a href="#关于链表集合" class="headerlink" title="关于链表集合"></a>关于链表集合</h3><pre><code>它有链表头和尾
插入快 查询慢 性能不安全</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">package org.entity;</span><br><span class="line">//定义一个链表结构</span><br><span class="line">public class Node &#123;</span><br><span class="line">	public Object obj;</span><br><span class="line">	</span><br><span class="line">	public Node prev;</span><br><span class="line">	</span><br><span class="line">	public Node next;</span><br><span class="line">	</span><br><span class="line">	public <span class="function"><span class="title">Node</span></span>() &#123;</span><br><span class="line">		// TODO Auto-generated constructor stub</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public Node(Object obj, Node prev, Node next) &#123;</span><br><span class="line">		this.obj = obj;</span><br><span class="line">		this.prev = prev;</span><br><span class="line">		this.next = next;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class text02 &#123;</span><br><span class="line">	</span><br><span class="line">	private Node first;</span><br><span class="line">	</span><br><span class="line">	private Node last;</span><br><span class="line">	</span><br><span class="line">	private int size;</span><br><span class="line"></span><br><span class="line">	public void add(Object obj) &#123;</span><br><span class="line">		Node node = new Node();</span><br><span class="line">		<span class="keyword">if</span>(first==null) &#123;</span><br><span class="line">			node.next = null;</span><br><span class="line">			node.prev = null;</span><br><span class="line">			node.obj = obj;</span><br><span class="line">			first = node;</span><br><span class="line">			last = node;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			node.prev = last;</span><br><span class="line">			node.next = null;</span><br><span class="line">			node.obj = obj;</span><br><span class="line">			last.next = node;</span><br><span class="line">			last = node;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		text02 t = new text02();</span><br><span class="line">		t.add(2);</span><br><span class="line">		t.add(3);</span><br><span class="line">		t.add(4);</span><br><span class="line">		System.out.println(t.last);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="添加节点的过程"><a href="#添加节点的过程" class="headerlink" title="添加节点的过程"></a>添加节点的过程</h3><p>首先加入第一个节点时 node first就是它自身 last也是它自身 它的上一个节点和下一个节点为null</p>
<p>当我们链表已经有节点时 再加入节点的时候 </p>
<p>当前的node.prev上一个节点 = last<br>当前的node.next下一个节点 = null<br>node.obj = obj 就是它本身的节点</p>
<p>接着</p>
<p>last是之前的node 也就是说上一个节点的地址，<br>这样我们就可以改变last.next = node 这样就变成了我们加入进来的node对象（因为上一个节点有next 和 prev）<br>再把last = node 这样就变成了我们下次进来的上一个节点为现在的节点<br>依此类推 就不断延续</p>
<h3 id="空构造法"><a href="#空构造法" class="headerlink" title="空构造法"></a>空构造法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public <span class="function"><span class="title">LinkedList</span></span>() &#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="有参构造法"><a href="#有参构造法" class="headerlink" title="有参构造法"></a>有参构造法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"> public LinkedList(Collection&lt;? extends E&gt; c) &#123;</span><br><span class="line">         this();</span><br><span class="line">         // 将集合添加到链表中去</span><br><span class="line">         addAll(c);</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line"> public boolean addAll(Collection&lt;? extends E&gt; c) &#123;</span><br><span class="line">         // 从链表尾巴开始集合中元素</span><br><span class="line">         <span class="built_in">return</span> addAll(size, c);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">public boolean addAll(int index, Collection&lt;? extends E&gt; c) &#123;</span><br><span class="line">     // 1.添加位置的下标的合理性检查</span><br><span class="line">     checkPositionIndex(index);</span><br><span class="line"></span><br><span class="line">     // 2.将集合转换为Object[]数组对象</span><br><span class="line">     Object[] a = c.toArray();</span><br><span class="line">     int numNew = a.length;</span><br><span class="line">     <span class="keyword">if</span> (numNew == 0)</span><br><span class="line">         <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">     // 3.得到插入位置的前继节点和后继节点</span><br><span class="line">     Node&lt;E&gt; pred, succ;</span><br><span class="line">     <span class="keyword">if</span> (index == size) &#123;</span><br><span class="line">         // 从尾部添加的情况：前继节点是原来的last节点；后继节点是null</span><br><span class="line">         succ = null;</span><br><span class="line">         pred = last;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        // 从指定位置（非尾部）添加的情况:前继节点就是index位置的节点，后继节点是index位置的节点的前一个节点</span><br><span class="line">         succ = node(index);</span><br><span class="line">         pred = succ.prev;</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">     // 4.遍历数据，将数据插入</span><br><span class="line">     <span class="keyword">for</span> (Object o : a) &#123;</span><br><span class="line">         @SuppressWarnings(<span class="string">"unchecked"</span>) E e = (E) o;</span><br><span class="line">         // 创建节点</span><br><span class="line">         Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, null);</span><br><span class="line">         <span class="keyword">if</span> (pred == null)</span><br><span class="line">             // 空链表插入情况：</span><br><span class="line">             first = newNode;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">             // 非空链表插入情况：</span><br><span class="line">             pred.next = newNode;</span><br><span class="line">         // 更新前置节点为最新插入的节点（的地址）</span><br><span class="line">         pred = newNode;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (succ == null) &#123;</span><br><span class="line">         // 如果是从尾部开始插入的，则把last置为最后一个插入的元素</span><br><span class="line">         last = pred;</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         // 如果不是从尾部插入的，则把尾部的数据和之前的节点连起来</span><br><span class="line">         pred.next = succ;</span><br><span class="line">         succ.prev = pred;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     size += numNew;  // 链表大小+num</span><br><span class="line">     modCount++;  // 修改次数加1</span><br><span class="line">     <span class="built_in">return</span> <span class="literal">true</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>


<h3 id="add-E-e-方法"><a href="#add-E-e-方法" class="headerlink" title="add(E e)方法"></a>add(E e)方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 作用：将元素添加到链表尾部</span><br><span class="line">   public boolean add(E e) &#123;</span><br><span class="line">       linkLast(e);</span><br><span class="line">       <span class="built_in">return</span> <span class="literal">true</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   void linkLast(E e) &#123;</span><br><span class="line">       final Node&lt;E&gt; l = last;  // 获取尾部元素</span><br><span class="line">       final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null); // 以尾部元素为前继节点创建一个新节点</span><br><span class="line">       last = newNode;  // 更新尾部节点为需要插入的节点</span><br><span class="line">       <span class="keyword">if</span> (l == null)</span><br><span class="line">	    // 如果空链表的情况：同时更新first节点也为需要插入的节点。（也就是说：该节点既是头节点first也是尾节点last）</span><br><span class="line">           first = newNode;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        // 不是空链表的情况：将原来的尾部节点（现在是倒数第二个节点）的next指向需要插入的节点</span><br><span class="line">           l.next = newNode;</span><br><span class="line">       size++; // 更新链表大小和修改次数，插入完毕</span><br><span class="line">       modCount++;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="add-int-index-E-element-方法"><a href="#add-int-index-E-element-方法" class="headerlink" title="add(int index, E element)方法"></a>add(int index, E element)方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// 作用：在指定位置添加元素</span><br><span class="line">   public void add(int index, E element) &#123;</span><br><span class="line">    // 检查插入位置的索引的合理性</span><br><span class="line">       checkPositionIndex(index);</span><br><span class="line">       //添加到尾部</span><br><span class="line">       <span class="keyword">if</span> (index == size)</span><br><span class="line">        // 插入的情况是尾部插入的情况：调用linkLast（）解释如上。</span><br><span class="line">           linkLast(element);</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        // 中间插入）：linkBefore（）见下面。</span><br><span class="line">           linkBefore(element, node(index));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   private void checkPositionIndex(int index) &#123;</span><br><span class="line">       <span class="keyword">if</span> (!isPositionIndex(index))</span><br><span class="line">           throw new IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class="line">   &#125;</span><br><span class="line">   //判断index是否正确参数</span><br><span class="line">   private boolean isPositionIndex(int index) &#123;</span><br><span class="line">       <span class="built_in">return</span> index &gt;= 0 &amp;&amp; index &lt;= size;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   void linkBefore(E e, Node&lt;E&gt; succ) &#123;</span><br><span class="line">       // assert succ != null;</span><br><span class="line">       final Node&lt;E&gt; pred = succ.prev;  //获取到输入下标的node上个节点是</span><br><span class="line">       final Node&lt;E&gt; newNode = new Node&lt;&gt;(pred, e, succ);  // pred设置为新元素的上一个节点 老的succ为下一个节点</span><br><span class="line">       succ.prev = newNode;  // 将succ的上一个节点设置为新的节点</span><br><span class="line">       <span class="keyword">if</span> (pred == null)</span><br><span class="line">        // 如果pred为null，说明该节点插入在头节点之前，要重置first头节点 </span><br><span class="line">           first = newNode;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        // 如果pred不为null，</span><br><span class="line">           pred.next = newNode;pred的下个节点等于新的节点对象</span><br><span class="line">       size++;</span><br><span class="line">       modCount++;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="get-int-index-方法"><a href="#get-int-index-方法" class="headerlink" title="get(int index)方法"></a>get(int index)方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">   public E get(int index) &#123;</span><br><span class="line">    // 元素下表的合理性检查</span><br><span class="line">       checkElementIndex(index);</span><br><span class="line">       // node(index)真正查询匹配元素并返回</span><br><span class="line">       <span class="built_in">return</span> node(index).item;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">// 作用：查询指定位置元素并返回</span><br><span class="line">   Node&lt;E&gt; node(int index) &#123;</span><br><span class="line">       // assert isElementIndex(index);</span><br><span class="line"></span><br><span class="line">	// 如果索引位置靠链表前半部分，从头开始遍历</span><br><span class="line">       <span class="keyword">if</span> (index &lt; (size &gt;&gt; 1)) &#123;</span><br><span class="line">           Node&lt;E&gt; x = first;</span><br><span class="line">           <span class="keyword">for</span> (int i = 0; i &lt; index; i++)</span><br><span class="line">               x = x.next;</span><br><span class="line">           <span class="built_in">return</span> x;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       // 如果索引位置靠链表后半部分，从尾开始遍历</span><br><span class="line">           Node&lt;E&gt; x = last;</span><br><span class="line">           <span class="keyword">for</span> (int i = size - 1; i &gt; index; i--)</span><br><span class="line">               x = x.prev;</span><br><span class="line">           <span class="built_in">return</span> x;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<h3 id="remove-int-index-方法"><a href="#remove-int-index-方法" class="headerlink" title="remove(int index)方法"></a>remove(int index)方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// 作用：移除指定位置的元素</span><br><span class="line">   public E remove(int index) &#123;</span><br><span class="line">    // 移除元素索引的合理性检查</span><br><span class="line">       checkElementIndex(index);</span><br><span class="line">       // 将节点删除</span><br><span class="line">       <span class="built_in">return</span> unlink(node(index));</span><br><span class="line">   &#125;</span><br><span class="line"> E unlink(Node&lt;E&gt; x) &#123;</span><br><span class="line">        // assert x != null;</span><br><span class="line">        final E element = x.item;  // 得到指定节点的值</span><br><span class="line">        final Node&lt;E&gt; next = x.next; // 得到指定节点的后继节点</span><br><span class="line">        final Node&lt;E&gt; prev = x.prev; // 得到指定节点的前继节点</span><br><span class="line"></span><br><span class="line">		// 如果prev为null表示删除是头节点，否则就不是头节点</span><br><span class="line">        <span class="keyword">if</span> (prev == null) &#123;</span><br><span class="line">            first = next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prev.next = next;2 3 4 去除掉3 2的下一个节点4</span><br><span class="line">            x.prev = null; // 置空需删除的指定节点的前置节点（null）</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">		// 如果next为null,则表示删除的是尾部节点，否则就不是尾部节点</span><br><span class="line">        <span class="keyword">if</span> (next == null) &#123;</span><br><span class="line">            last = prev;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            next.prev = prev;2 3 4 去除掉3 4的上一个节点2</span><br><span class="line">            x.next = null; //  置空需删除的指定节点的后置节点</span><br><span class="line">        &#125;</span><br><span class="line">		</span><br><span class="line">		// 置空需删除的指定节点的值</span><br><span class="line">        x.item = null;</span><br><span class="line">        size--; // 数量减1</span><br><span class="line">        modCount++;</span><br><span class="line">        <span class="built_in">return</span> element;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="clear-方法"><a href="#clear-方法" class="headerlink" title="clear()方法"></a>clear()方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 清空链表</span><br><span class="line">   public void <span class="function"><span class="title">clear</span></span>() &#123;</span><br><span class="line">       // Clearing all of the links between nodes is <span class="string">"unnecessary"</span>, but:</span><br><span class="line">       // - helps a generational GC <span class="keyword">if</span> the discarded nodes inhabit</span><br><span class="line">       //   more than one generation</span><br><span class="line">       // - is sure to free memory even <span class="keyword">if</span> there is a reachable Iterator</span><br><span class="line">    // 进行<span class="keyword">for</span>循环，进行逐条置空；直到最后一个元素</span><br><span class="line">       <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != null; ) &#123;</span><br><span class="line">           Node&lt;E&gt; next = x.next;</span><br><span class="line">           x.item = null;</span><br><span class="line">           x.next = null;</span><br><span class="line">           x.prev = null;</span><br><span class="line">           x = next;</span><br><span class="line">       &#125;</span><br><span class="line">       // 置空头和尾为null</span><br><span class="line">       first = last = null;</span><br><span class="line">       size = 0;</span><br><span class="line">       modCount++;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="indexOf-Object-o"><a href="#indexOf-Object-o" class="headerlink" title="indexOf(Object o)"></a>indexOf(Object o)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// 返回元素在链表中的索引，如果不存在则返回-1</span><br><span class="line">public int indexOf(Object o) &#123;</span><br><span class="line">      int index = 0;</span><br><span class="line">      // 如果元素为null，进行如下循环判断</span><br><span class="line">      <span class="keyword">if</span> (o == null) &#123;</span><br><span class="line">          <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != null; x = x.next) &#123;</span><br><span class="line">              <span class="keyword">if</span> (x.item == null)</span><br><span class="line">                  <span class="built_in">return</span> index;</span><br><span class="line">              index++;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      // 元素不为null.进行如下循环判断</span><br><span class="line">          <span class="keyword">for</span> (Node&lt;E&gt; x = first; x != null; x = x.next) &#123;</span><br><span class="line">              <span class="keyword">if</span> (o.equals(x.item))</span><br><span class="line">                  <span class="built_in">return</span> index;</span><br><span class="line">              index++;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">return</span> -1;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="addFirst-E-e-方法"><a href="#addFirst-E-e-方法" class="headerlink" title="addFirst(E e)方法"></a>addFirst(E e)方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> // 作用：在链表头插入指定元素</span><br><span class="line"> public void addFirst(E e) &#123;</span><br><span class="line">      linkFirst(e);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  private void linkFirst(E e) &#123;</span><br><span class="line">      final Node&lt;E&gt; f = first; // 获取头部元素</span><br><span class="line">      final Node&lt;E&gt; newNode = new Node&lt;&gt;(null, e, f); // 创建新的头部元素（原来的头部元素变成了第二个）</span><br><span class="line">      first = newNode;</span><br><span class="line"></span><br><span class="line">// 链表头部为空，（也就是链表为空）</span><br><span class="line">      <span class="keyword">if</span> (f == null)</span><br><span class="line">          last = newNode; // 头尾元素都是e</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">          f.prev = newNode;  // 否则就更新原来的头元素的prev为新元素的地址引用</span><br><span class="line">      size++;</span><br><span class="line">      modCount++;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="addLast-E-e-方法"><a href="#addLast-E-e-方法" class="headerlink" title="addLast(E e)方法"></a>addLast(E e)方法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 作用：在链表尾部添加元素e</span><br><span class="line">  public void addLast(E e) &#123;</span><br><span class="line">	// 上面已讲解过，参考上面。add()方法</span><br><span class="line">       linkLast(e);</span><br><span class="line">   &#125;</span><br><span class="line">   void linkLast(E e) &#123;</span><br><span class="line">       final Node&lt;E&gt; l = last;  // 获取尾部元素</span><br><span class="line">       final Node&lt;E&gt; newNode = new Node&lt;&gt;(l, e, null); // 以尾部元素为前继节点创建一个新节点</span><br><span class="line">       last = newNode;  // 更新尾部节点为需要插入的节点</span><br><span class="line">       <span class="keyword">if</span> (l == null)</span><br><span class="line">	    // 如果空链表的情况：同时更新first节点也为需要插入的节点。（也就是说：该节点既是头节点first也是尾节点last）</span><br><span class="line">           first = newNode;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        // 不是空链表的情况：将原来的尾部节点（现在是倒数第二个节点）的next指向需要插入的节点</span><br><span class="line">           l.next = newNode;</span><br><span class="line">       size++; // 更新链表大小和修改次数，插入完毕</span><br><span class="line">       modCount++;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-ArrayList"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/05/12/ArrayList/"
    >ArrayList</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/05/12/ArrayList/" class="article-date">
  <time datetime="2020-05-12T07:13:03.000Z" itemprop="datePublished">2020-05-12</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>列表集合</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class ArrayList&lt;E&gt; extends AbstractList&lt;E&gt; implements List&lt;E&gt;, RandomAccess, Cloneable, Serializable &#123;  </span><br><span class="line">    // 序列化id  </span><br><span class="line">    private static final long serialVersionUID = 8683452581122892189L;  </span><br><span class="line">    // 默认初始的容量  </span><br><span class="line">    private static final int DEFAULT_CAPACITY = 10;  </span><br><span class="line">    // 一个空对象（为什么是new Object[0]呢？）</span><br><span class="line">    //用Object[0]来代替null 很多时候我们需要传递参数的类型，而不是传null，所以用Object[0]</span><br><span class="line">    private static final Object[] EMPTY_ELEMENTDATA = new Object[0];  </span><br><span class="line">    // 一个空对象，如果使用默认构造函数创建，则默认对象内容默认是该值  </span><br><span class="line">    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = new Object[0];  </span><br><span class="line">    // 当前数据对象存放地方，当前对象不参与序列化(主要是关键字transient起作用的)  </span><br><span class="line">    transient Object[] elementData;  </span><br><span class="line">    // 当前数组长度  </span><br><span class="line">    private int size;  </span><br><span class="line">    // 数组最大长度  </span><br><span class="line">    private static final int MAX_ARRAY_SIZE = 2147483639;  </span><br><span class="line"></span><br><span class="line">    // 省略方法。。  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>默认object[] xxx = {}||new object[0]</p>
<p>这里规定了一个默认空对象的构造法方法 ：</p>
<p>private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = new Object[0];  </p>
<p>还有一个有参数的构造法 private static final Object[] EMPTY_ELEMENTDATA = new Object[0]; </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">public boolean add(E e) &#123;</span><br><span class="line">        ensureCapacityInternal(size + 1);  //确认内部容量</span><br><span class="line">        前面定义默认的size为0 所以每次添加新的值 size会加一</span><br><span class="line">        elementData[size++] = e;</span><br><span class="line">        <span class="built_in">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> private void ensureCapacityInternal(int minCapacity) &#123;</span><br><span class="line">        // 如果elementData 指向的是 DEFAULTCAPACITY_EMPTY_ELEMENTDATA 的地址</span><br><span class="line">        <span class="keyword">if</span> (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) &#123;</span><br><span class="line">            //置默认大小 为DEFAULT_CAPACITY</span><br><span class="line">            minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity);</span><br><span class="line"></span><br><span class="line">            DEFAULT_CAPACITY == 10 前面定义为10 minCapacity 是size+1进来的</span><br><span class="line">        	这里为何要加一的原因是数组的length有长度的话就是1 而下标是为0</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">        //确定实际容量</span><br><span class="line">        ensureExplicitCapacity(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private void ensureExplicitCapacity(int minCapacity) &#123;</span><br><span class="line">        modCount++;</span><br><span class="line"></span><br><span class="line">        // 如果超出了容量，进行扩展</span><br><span class="line">        <span class="keyword">if</span> (minCapacity - elementData.length &gt; 0)</span><br><span class="line">            grow(minCapacity);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">private void grow(int minCapacity) &#123;</span><br><span class="line">        // overflow-conscious code</span><br><span class="line">        int oldCapacity = elementData.length;</span><br><span class="line">        //右移运算符等价于除以2</span><br><span class="line">        int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1);</span><br><span class="line">        <span class="keyword">if</span> (newCapacity - minCapacity &lt; 0)</span><br><span class="line">            newCapacity = minCapacity;</span><br><span class="line">        <span class="keyword">if</span> (newCapacity - MAX_ARRAY_SIZE &gt; 0)</span><br><span class="line">            newCapacity = hugeCapacity(minCapacity);</span><br><span class="line">        // minCapacity is usually close to size, so this is a win:</span><br><span class="line">        elementData = Arrays.copyOf(elementData, newCapacity);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>上述代码块比较长，这里做个简单的总结：<br>1、add（E e）：添加元素，首先会判断 elementData 数组的长度，然后设置值<br>2、ensureCapacityInternal（int minCapacity）：判断 element 是否为空，如果是，则设置默认数组长度<br>3、ensureExplicitCapacity（int minCapacity）：判断预期增长数组长度是否超过当前容量，如果过超过，则调用grow（）<br>4、grow(int minCapacity)：对数组进行扩展，默认的长度为10</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public void add(int index, E element) &#123;</span><br><span class="line">    rangeCheckForAdd(index);</span><br><span class="line">    //确定容量</span><br><span class="line">    ensureCapacityInternal(size + 1);  // Increments modCount!!</span><br><span class="line">    System.arraycopy(elementData, index, elementData, index + 1,</span><br><span class="line">                     size - index);</span><br><span class="line">    elementData[index] = element;//将下标赋值</span><br><span class="line">    size++;//长度加一</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public ArrayList(int initialCapacity) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (initialCapacity &gt; 0) &#123;  </span><br><span class="line">        this.elementData = new Object[initialCapacity];  </span><br><span class="line">        //设置容量</span><br><span class="line">        如果值为0的时候 将赋值EMPTY_ELEMENTDATA &#123;0&#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (initialCapacity == 0) &#123;  </span><br><span class="line">        this.elementData = EMPTY_ELEMENTDATA; </span><br><span class="line">        //EMPTY_ELEMENTDATA</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">        throw new IllegalArgumentException(<span class="string">"Illegal Capacity: "</span>+  </span><br><span class="line">                                           initialCapacity);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ArrayList（）：指向 DEFAULTCAPACITY_EMPTY_ELEMENTDATA，当列表使用的时候，才会进行初始化，会通过判断是不是 DEFAULTCAPACITY_EMPTY_ELEMENTDATA 这个对象而设置数组默认大小。<br>ArrayList(int initialCapacity)：当 initialCapacity &gt;0 的时候，设置该长度。如果 initialCapacity =0，则指向 EMPTY_ELEMENTDATA 在使用的时候，并不会设置默认数组长度 。</p>
<p>因此 DEFAULTCAPACITY_EMPTY_ELEMENTDATA 与 EMPTY_ELEMENTDATA 的本质区别就在于，会不会设置默认的数组长度。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@HotSpotIntrinsicCandidate</span><br><span class="line">public static void (Object src,</span><br><span class="line">                             int srcPos,</span><br><span class="line">                             Object dest,</span><br><span class="line">                             int destPos,</span><br><span class="line">                             int length)</span><br><span class="line">src:源数组；     srcPos:源数组要复制的起始位置；</span><br><span class="line">dest:目的数组；  destPos:目的数组放置的起始位置；    length:复制的长度。</span><br><span class="line">注意：src and dest都必须是同类型或者可以进行转换类型的数组．</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public E remove(int index) &#123;</span><br><span class="line">        rangeCheck(index); // 判断索引是否有效</span><br><span class="line">        modCount++;</span><br><span class="line">        E oldValue = elementData(index);  // 获取对应数据</span><br><span class="line">        int numMoved = size - index - 1;  // 判断删除数据位置</span><br><span class="line">        <span class="keyword">if</span> (numMoved &gt; 0) //如果删除数据不是最后一位，则需要移动数组</span><br><span class="line">            System.arraycopy(elementData, index+1, elementData, index,</span><br><span class="line">                             numMoved);</span><br><span class="line">        elementData[--size] = null; // 让指针最后指向空，进行垃圾回收</span><br><span class="line">        <span class="built_in">return</span> oldValue;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>System.arraycopy(elementData, index+1, elementData, index,numMoved);<br>将原本的数组 下标加一复制到当前的下标的地方 </p>
<p>numMoved至于长度 == size(该数组的长度) - 下标 - 1 = 复制后面的长度（这里并不会影响到数组的容量）</p>
<p>elementData[–size] = null;将数组的size长度减一的坐标为null</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public boolean remove(Object o) &#123;</span><br><span class="line">        <span class="keyword">if</span> (o == null) &#123;</span><br><span class="line">            <span class="keyword">for</span> (int index = 0; index &lt; size; index++)</span><br><span class="line">                <span class="keyword">if</span> (elementData[index] == null) &#123;</span><br><span class="line">                    fastRemove(index);</span><br><span class="line">                    <span class="built_in">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (int index = 0; index &lt; size; index++)</span><br><span class="line">                <span class="keyword">if</span> (o.equals(elementData[index])) &#123;</span><br><span class="line">                    fastRemove(index);</span><br><span class="line">                    <span class="built_in">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这种方式，会在内部进行 AccessRandom 方式遍历数组，当匹配到数据跟 Object 相等，则调用 fastRemove（） 进行删除</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private void fastRemove(int index) &#123;</span><br><span class="line">       modCount++;</span><br><span class="line">       int numMoved = size - index - 1;</span><br><span class="line">       <span class="keyword">if</span> (numMoved &gt; 0)</span><br><span class="line">           System.arraycopy(elementData, index+1, elementData, index,</span><br><span class="line">                            numMoved);</span><br><span class="line">       elementData[--size] = null; // clear to <span class="built_in">let</span> GC <span class="keyword">do</span> its work</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>fastRemove( ): fastRemove 操作与上述的根据下标进行删除其实是一致的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">private boolean batchRemove(Collection&lt;?&gt; c, boolean complement) &#123;</span><br><span class="line">       //获取数组指针</span><br><span class="line">       final Object[] elementData = this.elementData;</span><br><span class="line">       int r = 0, w = 0;</span><br><span class="line">       r为控制循环 w为交集多少个交集</span><br><span class="line">       boolean modified = <span class="literal">false</span>;</span><br><span class="line">       try &#123;</span><br><span class="line">           <span class="keyword">for</span> (; r &lt; size; r++)</span><br><span class="line">               //根据 complement 进行判断是否一致 </span><br><span class="line">               <span class="keyword">if</span> (c.contains(elementData[r]) == complement)</span><br><span class="line">                   elementData[w++] = elementData[r];</span><br><span class="line">       &#125; finally &#123;</span><br><span class="line">           // 进行数据整理</span><br><span class="line">           <span class="keyword">if</span> (r != size) &#123;</span><br><span class="line">               System.arraycopy(elementData, r,</span><br><span class="line">                                elementData, w,</span><br><span class="line">                                size - r);</span><br><span class="line">               w += size - r;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span> (w != size) &#123;</span><br><span class="line">               // clear to <span class="built_in">let</span> GC <span class="keyword">do</span> its work</span><br><span class="line">               <span class="keyword">for</span> (int i = w; i &lt; size; i++)</span><br><span class="line">                   elementData[i] = null;</span><br><span class="line">               modCount += size - w;</span><br><span class="line">               size = w;</span><br><span class="line">               modified = <span class="literal">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">return</span> modified;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public E <span class="built_in">set</span>(int index, E e) &#123;</span><br><span class="line">        rangeCheck(index);//判断是否有校index</span><br><span class="line">        checkForComodification();</span><br><span class="line">        //旧值</span><br><span class="line">        E oldValue = ArrayList.this.elementData(offset + index);</span><br><span class="line">        //赋新值</span><br><span class="line">        ArrayList.this.elementData[offset + index] = e;</span><br><span class="line">        //返回旧值</span><br><span class="line">        <span class="built_in">return</span> oldValue;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public int indexOf(Object o) &#123;</span><br><span class="line">		//索引为null的值</span><br><span class="line">        <span class="keyword">if</span> (o == null) &#123;</span><br><span class="line">            <span class="keyword">for</span> (int i = 0; i &lt; size; i++)</span><br><span class="line">                <span class="keyword">if</span> (elementData[i]==null)</span><br><span class="line">                    <span class="built_in">return</span> i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        //找出一样的值</span><br><span class="line">            <span class="keyword">for</span> (int i = 0; i &lt; size; i++)</span><br><span class="line">                <span class="keyword">if</span> (o.equals(elementData[i]))</span><br><span class="line">                    <span class="built_in">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        //找不到为null</span><br><span class="line">        <span class="built_in">return</span> -1;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>//判断索引的值会不会大于数组的长度<br>public E get(int index) {<br>        rangeCheck(index);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    return elementData(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-input焦点"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/04/16/input%E7%84%A6%E7%82%B9/"
    >input焦点</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/04/16/input%E7%84%A6%E7%82%B9/" class="article-date">
  <time datetime="2020-04-16T00:22:25.000Z" itemprop="datePublished">2020-04-16</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="change-当改变时触发"><a href="#change-当改变时触发" class="headerlink" title="change 当改变时触发"></a>change 当改变时触发</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">可回车确认</span><br><span class="line"><span class="variable">$item</span>.children(<span class="string">"#file"</span>).on(<span class="string">"change"</span>, <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">     console.log($(this).val())</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="每次输入都获取值-input"><a href="#每次输入都获取值-input" class="headerlink" title="每次输入都获取值 input"></a>每次输入都获取值 input</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$item</span>.children(<span class="string">"#file"</span>).on(<span class="string">"input"</span>, <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">     console.log($(this).val())</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="blur-失去焦点时"><a href="#blur-失去焦点时" class="headerlink" title="blur 失去焦点时"></a>blur 失去焦点时</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">不可回车键</span><br><span class="line"><span class="variable">$item</span>.children(<span class="string">"#file"</span>).on(<span class="string">"blur"</span>, <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">     console.log($(this).val())</span><br><span class="line">&#125;)</span><br><span class="line">//激活回车键</span><br><span class="line"><span class="variable">$item</span>.<span class="built_in">bind</span>(<span class="string">"keydown keyup"</span>,<span class="keyword">function</span>(e)&#123;</span><br><span class="line">    var key = e.which;</span><br><span class="line">    <span class="keyword">if</span> (key == 13) &#123;</span><br><span class="line">        console.log($(this).val())</span><br><span class="line">        $(this).css(<span class="string">"outline"</span>,<span class="string">"none"</span>);</span><br><span class="line">        $(this).attr(<span class="string">"readonly"</span>,<span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="focus-点击获取焦点时"><a href="#focus-点击获取焦点时" class="headerlink" title="focus 点击获取焦点时"></a>focus 点击获取焦点时</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$item</span>.children(<span class="string">"#file"</span>).on(<span class="string">"focus"</span>, <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">     console.log($(this).val())</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-关于session错误"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/31/%E5%85%B3%E4%BA%8Esession%E9%94%99%E8%AF%AF/"
    >关于session错误</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/03/31/%E5%85%B3%E4%BA%8Esession%E9%94%99%E8%AF%AF/" class="article-date">
  <time datetime="2020-03-31T02:52:31.000Z" itemprop="datePublished">2020-03-31</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>使用spring mvc进行Java web开发时，如果同时使用@SessionAttributes 和@ResponseBody注解，就会出现</p>
<p>“java.lang.IllegalStateException: Cannot create a session after the response has been committed ”这个错误。这是为什么呢，因为我们在创建session前，已经将response进行了提交。</p>
<p>下面通过一个例子进行说明：</p>
<p>@Controller<br>@RequestMapping(“/“)<br>@SessionAttributes(value = {“user”})<br>public class UserController {</p>
<pre><code>@ResponseBody
@RequestMapping(&quot;add&quot;)
public String method1(ModelMap map) {

    User user = new User();
    map.addAttribute(&quot;user&quot;, user);
    return &quot;success&quot;;
}

@ResponseBody
@RequestMapping(&quot;update&quot;)
public String method2(ModelMap map ) {
    System.out.println(map.get(&quot;user&quot;));
    return &quot;success&quot;;
}</code></pre><p>}</p>
<p>当访问method1时，就会报上面错误。原因是@SessionAttributes中定义了ModelMap中哪些属性将要存入session中。因为这个存入session的动作是在method1方法结束后发生的，而return 语句一结束，response就会立即被返回，因此就会造成</p>
<p>“Cannot not create session after response has been committed”。</p>
<p>解决方法：</p>
<p>在return之前，创建自己的session，即将上面的method1变成如下：</p>
<p>@ResponseBody<br>    @RequestMapping(“add”)<br>    public String method1(ModelMap map， HttpSession session) {</p>
<pre><code>    User user = new User();
    map.addAttribute(&quot;user&quot;, user);
    return &quot;success&quot;;
}</code></pre><p>这样就能保证在return之前，session已将被创建。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-关于前台传值到后台"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/28/%E5%85%B3%E4%BA%8E%E5%89%8D%E5%8F%B0%E4%BC%A0%E5%80%BC%E5%88%B0%E5%90%8E%E5%8F%B0/"
    >关于前台传值到后台</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/03/28/%E5%85%B3%E4%BA%8E%E5%89%8D%E5%8F%B0%E4%BC%A0%E5%80%BC%E5%88%B0%E5%90%8E%E5%8F%B0/" class="article-date">
  <time datetime="2020-03-28T08:09:31.000Z" itemprop="datePublished">2020-03-28</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="关于ajax的data"><a href="#关于ajax的data" class="headerlink" title="关于ajax的data"></a>关于ajax的data</h3><p>data<br>类型：String<br>发送到服务器的数据。将自动转换为请求字符串格式。GET 请求中将附加在 URL 后。查看 processData 选项说明以禁止此自动转换。必须为 Key/Value 格式。如果为数组，jQuery 将自动为不同值对应同一个名称。如 {foo:[“bar1”, “bar2”]} 转换为 ‘&amp;foo=bar1&amp;foo=bar2’。</p>
<p>当使用ajax的时候，contentType是默认的情况下，<br>后台使用自动注入值是没有问题的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(/)</span><br><span class="line">public String show(默认可以自动注入实体类)&#123;</span><br><span class="line">	这里是获取值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="那么当不使用注入实体类的话，默认String-也会根据类型而注入-但一般只能根据字符串赋值-因为前端的data是字符串"><a href="#那么当不使用注入实体类的话，默认String-也会根据类型而注入-但一般只能根据字符串赋值-因为前端的data是字符串" class="headerlink" title="那么当不使用注入实体类的话，默认String 也会根据类型而注入 但一般只能根据字符串赋值 因为前端的data是字符串"></a>那么当不使用注入实体类的话，默认String 也会根据类型而注入 但一般只能根据字符串赋值 因为前端的data是字符串</h3><p>@RequestPram</p>
<h3 id="当请求-RequstBody的话"><a href="#当请求-RequstBody的话" class="headerlink" title="当请求@RequstBody的话"></a>当请求@RequstBody的话</h3><p>那么返回必须为json字符串，而且需要用实体类来自动注入 而注入是通过用set根据命名来注入，所以名字不能乱，如果乱的话会导致参数为null，那么就会报error 一般是400参数异常<br>前端 需要加上请求头json</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-自定义异常类"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/28/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E7%B1%BB/"
    >自定义异常类</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/03/28/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E7%B1%BB/" class="article-date">
  <time datetime="2020-03-28T07:51:20.000Z" itemprop="datePublished">2020-03-28</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="自定义异常类"><a href="#自定义异常类" class="headerlink" title="自定义异常类"></a>自定义异常类</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class (命名)Exception extends Exception&#123;</span><br><span class="line">	public (命名)Exception(String errorMessage)&#123;</span><br><span class="line">		//重写父类的异常打印信息</span><br><span class="line">		super(errorMessage);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="抛出自定义异常"><a href="#抛出自定义异常" class="headerlink" title="抛出自定义异常"></a>抛出自定义异常</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public void verity() throws Exception&#123;</span><br><span class="line">	<span class="keyword">if</span>(age&gt;100)&#123;</span><br><span class="line">		throws new (命名)Exception(<span class="string">"报错"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
    <article
  id="post-后台分页"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/03/22/%E5%90%8E%E5%8F%B0%E5%88%86%E9%A1%B5/"
    >后台分页</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/03/22/%E5%90%8E%E5%8F%B0%E5%88%86%E9%A1%B5/" class="article-date">
  <time datetime="2020-03-22T13:06:13.000Z" itemprop="datePublished">2020-03-22</time>
</a>    
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="后台"><a href="#后台" class="headerlink" title="后台"></a>后台</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(<span class="string">"/Blog"</span>)</span><br><span class="line">public String show(@RequestParam(value = <span class="string">"currentpage"</span>,required = <span class="literal">false</span>) String currentpage,Model model)&#123;</span><br><span class="line">    //总数据</span><br><span class="line">    int count = articleservice.articletotal();</span><br><span class="line">    List&lt;Article&gt; article = null;</span><br><span class="line">    将页面设置为1</span><br><span class="line">    <span class="keyword">if</span>(currentpage==null) &#123;</span><br><span class="line">        currentpage = <span class="string">"1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    int Currentpage = Integer.parseInt(currentpage);</span><br><span class="line">    //分页大小</span><br><span class="line">    int Pagesize = 4;</span><br><span class="line">    请求数据每次减一 因为mysql是从0开始查询数据<span class="built_in">limit</span></span><br><span class="line">    article = articleservice.SelectPage((Currentpage-1)*Pagesize,Pagesize);</span><br><span class="line">    分页工具类</span><br><span class="line">    ArticlePage page = new ArticlePage();</span><br><span class="line">    当前页面</span><br><span class="line">    page.setCurrentPage(<span class="string">""</span>+(Currentpage));</span><br><span class="line">    左2右2</span><br><span class="line">    page.setAddPage(<span class="string">""</span>+(Currentpage+2));</span><br><span class="line">    分页数据</span><br><span class="line">    page.setArticle(article);</span><br><span class="line">    总页面 当总数据除分页大小 如果不整除的话加1</span><br><span class="line">    page.setTotalPage(count%Pagesize==0?<span class="string">""</span>+count/Pagesize:<span class="string">""</span>+(count/Pagesize+1));</span><br><span class="line">   	</span><br><span class="line">    这里可以设置当前页面首页出现几页出来和末尾出来</span><br><span class="line"></span><br><span class="line">   	设置属性</span><br><span class="line">    model.addAttribute(<span class="string">"page"</span>,page);</span><br><span class="line">    System.out.println(count);</span><br><span class="line">    <span class="built_in">return</span> <span class="string">"Home"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="前台"><a href="#前台" class="headerlink" title="前台"></a>前台</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">//总页等于尾页</span><br><span class="line">var totalpage = [[<span class="variable">$&#123;page.TotalPage&#125;</span>]]</span><br><span class="line">//当前页面</span><br><span class="line">var currentpage = [[<span class="variable">$&#123;page.CurrentPage&#125;</span>]]</span><br><span class="line">//增加页面</span><br><span class="line">var addpage = [[<span class="variable">$&#123;page.addPage&#125;</span>]]</span><br><span class="line">//这里可以获取一个后台来的属性 设置首页要显示几个页面选择和尾页显示几个页面选择 这里我是默认为5</span><br><span class="line">//页面属性class</span><br><span class="line">var <span class="variable">$page</span> = $(<span class="string">".page"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(+currentpage&lt;=+totalpage)&#123;</span><br><span class="line">    //分页</span><br><span class="line">    <span class="keyword">if</span>(currentpage==totalpage)&#123;</span><br><span class="line">        <span class="keyword">if</span>(totalpage&gt;=5)&#123;</span><br><span class="line">            <span class="keyword">for</span>(var count = totalpage-4; count&lt;totalpage; count++)&#123;</span><br><span class="line">                <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+count+<span class="string">'" class="content_in_page"&gt;'</span>+count+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(var count = 1;count&lt;totalpage;count++)&#123;</span><br><span class="line">                <span class="variable">$page</span>.append($(<span class="string">'&lt;a class="content_in_page" href="manage?currentpage='</span>+count+<span class="string">'"  &gt;'</span>+count+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //这个为尾页也是当前页</span><br><span class="line">        <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+currentpage+<span class="string">'" class="content_in_page currentpage"&gt;'</span>+currentpage+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(currentpage==1)&#123;</span><br><span class="line">        //循环前五个页面出来</span><br><span class="line">        <span class="keyword">if</span>(totalpage&gt;=5)&#123;</span><br><span class="line">            <span class="keyword">for</span>(var i = currentpage;i&lt;=5;i++)&#123;</span><br><span class="line">                //将当前页为蓝色</span><br><span class="line">                <span class="keyword">if</span>(i==currentpage)&#123;</span><br><span class="line">                    <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+i+<span class="string">'" class="content_in_page currentpage"&gt;'</span>+i+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+i+<span class="string">'" class="content_in_page"&gt;'</span>+i+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            //尾页小于5</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(var i = currentpage;i&lt;=totalpage;i++)&#123;</span><br><span class="line">                //将当前页为蓝色</span><br><span class="line">                <span class="keyword">if</span>(i==currentpage)&#123;</span><br><span class="line">                    <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+i+<span class="string">'" class="content_in_page currentpage"&gt;'</span>+i+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+i+<span class="string">'" class="content_in_page"&gt;'</span>+i+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        //分页格数</span><br><span class="line">        var addpagesize = addpage-currentpage;</span><br><span class="line">        var flag;</span><br><span class="line">        //倒数第二页 总页数-1</span><br><span class="line">        var lastbutone = Number(totalpage)-1;</span><br><span class="line">        //第二页 当前页加额外页面 -1</span><br><span class="line">        var secondpage = Number(currentpage)+Number(addpage)-1;</span><br><span class="line">        //当前页面等于第二页面时</span><br><span class="line">        <span class="keyword">if</span>(currentpage==2)&#123;</span><br><span class="line">            flag = secondpage;</span><br><span class="line">        //当前页面等于倒数第二页时</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(currentpage==lastbutone)&#123;</span><br><span class="line">            flag = lastbutone-(Number(addpage)-Number(currentpage))-1;</span><br><span class="line">        &#125;</span><br><span class="line">        //倒数第二页-（当前增加页面-当前页面）再减一 9-（12-9）-1</span><br><span class="line">        var lastPage = lastbutone-(Number(addpage)-Number(currentpage))-1;</span><br><span class="line">        //等于倒数第二页时</span><br><span class="line">        console.log(lastPage)</span><br><span class="line">        <span class="keyword">if</span> (flag==lastPage&amp;&amp;flag!=0) &#123;</span><br><span class="line">            <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+flag+<span class="string">'" class="content_in_page"&gt;'</span>+flag+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        //当点击页面为3时 那么就是前后加俩页 就为 1 2 3 4 5</span><br><span class="line">        <span class="keyword">for</span>(var i = currentpage-addpagesize;i&lt;=addpage;i++)&#123;</span><br><span class="line">            //大于等于1 并且 小于等于尾页</span><br><span class="line">            <span class="keyword">if</span>(i&gt;=1&amp;&amp;i&lt;=totalpage)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i==currentpage)&#123;</span><br><span class="line">                    //打印当前页面</span><br><span class="line">                    <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+i+<span class="string">'" class="content_in_page currentpage"&gt;'</span>+i+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+i+<span class="string">'" class="content_in_page"&gt;'</span>+i+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //等于第二页时</span><br><span class="line">        <span class="keyword">if</span>(flag==secondpage&amp;&amp;flag&lt;totalpage)&#123;</span><br><span class="line">            <span class="variable">$page</span>.append($(<span class="string">'&lt;a href="manage?currentpage='</span>+flag+<span class="string">'" class="content_in_page"&gt;'</span>+flag+<span class="string">'&lt;/a&gt;'</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

    
 
   
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2021
        <i class="ri-heart-fill heart_icon"></i> John Doe
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by <a href="https://hexo.io" target="_blank">Hexo</a>
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="叶枫"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i></p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->

<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=1808492017&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
  </div>
</body>

</html>